<!DOCTYPE html>

{% load staticfiles %} <!--Load the static folder will be referenced later-->

<html>
	<head>
		<title>Ocu-Pants</title>
		<meta charset="utf-8">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<link rel="stylesheet" href="{% static 'css/style.css' %}"> <!--load style.css from static folder-->
	</head>
	
	<body>
       <form action="" method="POST">{% csrf_token %} <!--form to select room using post method and sending a csrf token-->
            <select name="roomForm" onchange="this.form.submit()"> <!--submit on change-->
                <option value="" selected></option>
                {% for room in roomList %} <!--automatically generate the form options from roomList-->
                <option value="{{ room.room }}">{{ room.room }}</option>
            {% endfor %}
            </select>
        </form>
        
        <div class="centered"> <!--Display each field of the returned room object-->
            <h3>{{ roomObj.0.campus }}  {{ roomObj.0.building }}  {{ roomObj.0.room }}  {{ roomObj.0.capacity }}</h3><br>
            <h3>{{ timeList }}</h3>
        </div>
        
        <div class="centered" id="tableDiv" style="Display: block">
            <table> <!--Display the table headings-->
                <tr><th></th><th>Monday</th><th>Tuesday</th><th>Wednesday</th><th>Thursday</th><th>Friday</th></tr> 

                {% for y in timeList %} <!--build rows by identifing each timeslot 9am - 5pm in turn-->

                    <tr><th>{{ y }}</th>
                        
                    {% for timeSlot in roomSchedule %} <!--build columns by cycling through the object and displaying the module with the correct time-->
                        {% if timeSlot.datetime.hour == y.hour  %}
                            <td id="{{ timeSlot.timemoduleid }}" onclick="CellClick({{ timeSlot.timemoduleid }})">{{ timeSlot.module.modulename }}</td> <!--Display the cell-->
                        {% endif %}
                    {% endfor %}
                    </tr>
                {% endfor %}
            </table>
        </div>
        <div class="centered" id="testDiv">test</div>
        <div class="centered" id="graphDiv">
            
            <button>Test</button><br>
            {% csrf_token %}
            <p id="test">test</p><br>
            
        </div>
    </body>
    
    <script>
        
        $(document).ready(function() {
            $("button").click(function(){
                $.ajax({
                    method: "POST",
                    data: {csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value,},
                    url: "/test",
                    success: function(result) {
                    $("#testDiv").html(result);
                }})
            });
        });
        
        
        function CellClick(x) {
            
            document.getElementById(x).style.backgroundColor = 'green';
            
            
            
        }
                              
    </script>
</html>                